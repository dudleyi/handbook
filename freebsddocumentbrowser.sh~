#!/bin/sh

DOCS_PATH="/usr/local/share/freebsd/"

# Ensure the documentation path exists
if [ ! -d "$DOCS_PATH" ]; then
  echo "Documentation directory $DOCS_PATH not found."
  exit 1
fi

# Function to display a menu of files and directories
display_menu() {
  local current_path="$1"
  clear
  echo "Browsing: $current_path"
  echo "========================================"
  echo "Use arrow keys to navigate, Enter to open, 'q' to quit."
  echo "========================================"

  # List directories and files with a numeric menu
  local i=1
  for item in "$current_path"/*; do
    if [ -d "$item" ]; then
      echo "[$i] üìÅ $(basename "$item")"
    elif [ -f "$item" ]; then
      echo "[$i] üìÑ $(basename "$item")"
    fi
    i=$((i + 1))
  done
}

# Function to handle file display
view_file() {
  local file_path="$1"
  clear
  echo "Viewing: $file_path"
  echo "========================================"
  less "$file_path"
}

# Main navigation function
navigate() {
  local current_path="$DOCS_PATH"
  while true; do
    display_menu "$current_path"

    # Read user input
    echo
    echo -n "Enter your choice (or 'q' to quit): "
    read -r choice

    # Quit the program
    if [ "$choice" = "q" ]; then
      break
    fi

    # Navigate to the selected item
    selected_item=$(ls "$current_path" | sed -n "${choice}p")
    selected_path="$current_path/$selected_item"

    if [ -d "$selected_path" ]; then
      current_path="$selected_path"
    elif [ -f "$selected_path" ]; then
      view_file "$selected_path"
    else
      echo "Invalid choice. Please try again."
      sleep 2
    fi
  done
}

# Start the navigation
navigate
